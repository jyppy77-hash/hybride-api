<!DOCTYPE html>
<html lang="{{ lang }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, interactive-widget=resizes-content">

    {# ── Page-specific head (title, meta, OG, JSON-LD) ── #}
    {% block head %}{% endblock %}

    {# ── Hreflang ── #}
    {% for tag in hreflang_tags %}
    <link rel="alternate" hreflang="{{ tag.lang }}" href="{{ tag.url }}">
    {% endfor %}

    {# ── Favicons ── #}
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/ui/static/favicon.svg" type="image/svg+xml">
    <link rel="shortcut icon" href="/favicon.ico">

    {# ── Common CSS ── #}
    <link rel="stylesheet" href="/ui/static/style.css?v=1">
    <link rel="stylesheet" href="/ui/static/style-em.css?v=1">
    {% block extra_css %}{% endblock %}
    <link rel="stylesheet" href="/ui/static/legal.css?v=1">

    {# ── Theme + Analytics ── #}
    <script src="/ui/static/theme.js?v=1"></script>
    <script src="/ui/static/analytics.js?v=1" defer></script>
    <script>function umamiBeforeSend(t,p){return window.__OWNER__?false:p;}</script>
    <script defer src="https://cloud.umami.is/script.js" data-website-id="e6add519-5d39-42cd-b4bf-b795f4408dcc" data-before-send="umamiBeforeSend"></script>

    {% block head_end %}{% endblock %}
</head>
<body class="{{ body_class|default('subpage em-page') }}">

    {# ── Navigation ── #}
    <nav class="engine-nav-subpage">
        <a href="{{ nav_back_url|default(em_base) }}" class="engine-nav-btn">
            <span class="nav-arrow">&larr;</span>
            <span class="nav-text">{% block nav_back_text %}{{ _('Accueil EuroMillions') }}{% endblock %}</span>
        </a>
        <div class="engine-nav-right">
            <span class="engine-badge">EuroMillions</span>
            <button id="theme-switch" class="theme-switch" title="{{ _('Changer de thème') }}">
                <span class="icon-day">&#9728;&#65039;</span>
                <span class="icon-night">&#127769;</span>
            </button>
            <a href="{{ lang_switch_url }}" class="lang-switch" title="{{ lang_switch_title }}">{{ lang_switch_label }}</a>
        </div>
    </nav>

    {# ── Page body (content + footer inside page container) ── #}
    {% block body %}{% endblock %}

    {# ── Page-specific scripts (before common) ── #}
    {% block page_scripts %}{% endblock %}

    {# ── Scroll to top ── #}
    <button id="scroll-to-top" class="scroll-to-top" aria-label="{{ _('Retour en haut') }}">&uarr;</button>

    {# ── Common scripts ── #}
    <script src="/ui/static/scroll.js?v=1"></script>
    {% if include_nav_scroll %}<script src="/ui/static/nav-scroll.js?v=1"></script>{% endif %}
    <script src="/ui/static/cookie-consent.js?v=1"></script>

    {# ── Chatbot widget ── #}
    <link rel="stylesheet" href="/ui/static/hybride-chatbot.css?v=4.3">
    <div id="hybride-chatbot-root"></div>
    <script src="{{ chatbot_js }}"></script>
    <script src="/ui/static/version-inject.js"></script>

    {# ── Rating popup ── #}
    <link rel="stylesheet" href="/ui/static/rating-popup.css?v=1">
    <script src="{{ rating_js }}" defer></script>

    {% block post_scripts %}{% endblock %}
</body>
</html>
