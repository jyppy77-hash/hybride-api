<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Statistiques Loto France - Frequences et Tendances | LotoIA</title>
    <meta name="description" content="Statistiques completes du Loto francais : frequences des numeros, tendances, numeros chauds et froids, historique des tirages depuis 2019.">
    <link rel="canonical" href="https://lotoia.fr/statistiques">
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="LotoIA">
    <meta property="og:locale" content="fr_FR">
    <meta property="og:title" content="Statistiques Loto France | LotoIA">
    <meta property="og:description" content="Frequences, tendances et numeros chauds/froids du Loto francais depuis 2019.">
    <meta property="og:url" content="https://lotoia.fr/statistiques">
    <meta property="og:image" content="https://lotoia.fr/static/og-image.png">
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Statistiques Loto France | LotoIA">
    <meta name="twitter:description" content="Frequences, tendances et numeros chauds/froids du Loto francais.">
    <meta name="twitter:image" content="https://lotoia.fr/static/og-image.png">
    <!-- JSON-LD Schema.org -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Dataset",
      "name": "Statistiques Loto France",
      "description": "Statistiques des tirages du Loto francais depuis 2019",
      "url": "https://lotoia.fr/statistiques",
      "creator": {
        "@type": "Organization",
        "name": "LotoIA"
      },
      "temporalCoverage": "2019/.."
    }
    </script>
    <link rel="stylesheet" href="/ui/static/style.css">
    <link rel="stylesheet" href="/ui/static/legal.css">
    <!-- Theme script (en premier pour √©viter le flash) -->
    <script src="/ui/static/theme.js"></script>
    <!-- Analytics (charge apres consentement RGPD) -->
    <script src="/ui/static/analytics.js" defer></script>
    <style>
        /* Page premium stats - h√©rite du ch√¢ssis unifi√© (style.css) */
        .stats-page {
            min-height: 100vh;
            /* background g√©r√© par style.css (fond bleu nuit global) */
        }

        .page-header {
            background: var(--theme-bg-header);
            color: var(--theme-text-on-dark);
            padding: 30px 20px 80px;
            text-align: center;
            position: relative;
            overflow: hidden;
            transition: background 0.4s ease;
        }

        .page-header::before {
            content: '1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            font-weight: 700;
            letter-spacing: 6px;
            line-height: 2.2;
            color: rgba(255, 255, 255, 0.03);
            word-wrap: break-word;
            overflow: hidden;
            pointer-events: none;
        }

        .page-header::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image:
                radial-gradient(circle at 15% 50%, rgba(59, 130, 246, 0.12) 0%, transparent 40%),
                radial-gradient(circle at 85% 30%, rgba(139, 92, 246, 0.1) 0%, transparent 35%);
            pointer-events: none;
        }

        .header-nav {
            max-width: var(--app-max-width, 1140px);
            margin: 0 auto 24px;
            text-align: left;
            position: relative;
            z-index: 2;
        }

        .header-content {
            position: relative;
            z-index: 2;
        }

        .header-content h1 {
            font-size: 42px;
            font-weight: 800;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 16px;
        }

        .header-content .subtitle {
            font-size: 18px;
            opacity: 0.9;
            color: rgba(255, 255, 255, 0.9);
        }

        .stats-container {
            /* Utilise le ch√¢ssis unifi√© */
            max-width: var(--app-max-width, 1140px);
            margin: -50px auto 40px;
            padding: 0 var(--app-padding-x, 24px);
            position: relative;
            z-index: 10;
        }

        .tabs-card {
            background: white;
            border-radius: 16px;
            padding: 32px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }

        /* Styles pour les onglets */
        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 32px;
            border-bottom: 2px solid var(--border);
            flex-wrap: wrap;
        }

        .tab {
            padding: 16px 24px;
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-muted);
            transition: all 0.3s ease;
            font-family: inherit;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab:hover {
            color: var(--primary);
            background: rgba(102, 126, 234, 0.05);
        }

        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        /* Contenu des onglets */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.4s ease-in;
        }

        /* Styles pour l'analyse par num√©ro */
        .number-selector {
            display: flex;
            gap: 12px;
            align-items: center;
            margin-bottom: 24px;
        }

        .number-selector select {
            padding: 12px 16px;
            font-size: 1.05rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-family: inherit;
            min-width: 120px;
        }

        .number-selector select:focus {
            outline: none;
            border-color: var(--primary);
        }

        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: var(--bg-light);
            border-left: 4px solid var(--primary);
            padding: 20px;
            border-radius: 8px;
        }

        .stat-card .stat-label {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-bottom: 8px;
        }

        .stat-card .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--text-dark);
        }

        .dates-list {
            background: var(--bg-light);
            border-radius: 8px;
            padding: 20px;
            max-height: 300px;
            overflow-y: auto;
        }

        .dates-list h3 {
            font-size: 1.1rem;
            margin-bottom: 16px;
            color: var(--text-dark);
        }

        .date-item {
            padding: 8px 12px;
            background: white;
            border-radius: 4px;
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        .info-note {
            background: #E3F2FD;
            border-left: 4px solid #2196F3;
            padding: 16px;
            border-radius: 8px;
            margin-top: 24px;
            font-size: 0.95rem;
            color: #0D47A1;
        }

        /* Historique - styles existants de historique.html */
        .search-form {
            margin-bottom: 24px;
        }

        .search-form label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-dark);
        }

        .search-form .input-group {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .search-form input[type="date"] {
            padding: 12px 16px;
            font-size: 1.05rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-family: inherit;
        }

        .search-result {
            background: var(--bg-light);
            border-radius: 8px;
            padding: 24px;
            margin-top: 24px;
        }

        .search-result.error {
            background: #FFEBEE;
            border-left: 4px solid var(--error);
            color: #B71C1C;
        }

        .search-result.not-found {
            background: #FFF3E0;
            border-left: 4px solid #F57C00;
            color: #E65100;
        }

        .draw-numbers {
            display: flex;
            gap: 12px;
            margin: 16px 0;
            flex-wrap: wrap;
        }

        .draw-number {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 700;
            box-shadow: 0 4px 8px rgba(74, 144, 226, 0.3);
        }

        .draw-number.chance {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            box-shadow: 0 4px 8px rgba(255, 215, 0, 0.4);
        }

        /* Styles Top/Flop */
        .topflop-section {
            margin-bottom: 32px;
        }

        .topflop-section h3 {
            font-size: 1.3rem;
            margin-bottom: 16px;
            color: var(--text-dark);
        }

        .topflop-section h3.top-title {
            color: var(--success);
        }

        .topflop-section h3.flop-title {
            color: var(--tertiary);
        }

        .numbers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 12px;
            margin-bottom: 16px;
        }

        .number-card {
            background: var(--bg-light);
            border-radius: 8px;
            padding: 16px 12px;
            text-align: center;
            border: 2px solid var(--border);
            transition: all 0.3s ease;
        }

        .number-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .number-card.top {
            border-color: var(--success);
            background: linear-gradient(135deg, #E8F5E9 0%, #FFFFFF 100%);
        }

        .number-card.flop {
            border-color: var(--tertiary);
            background: linear-gradient(135deg, #F5F5F5 0%, #FFFFFF 100%);
        }

        .number-card .number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 8px;
        }

        .number-card.top .number {
            color: var(--success);
        }

        .number-card.flop .number {
            color: var(--tertiary);
        }

        .number-card .count {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        @media (max-width: 768px) {
            .numbers-grid {
                grid-template-columns: repeat(5, 1fr);
                gap: 8px;
            }

            .number-card {
                padding: 12px 8px;
            }

            .number-card .number {
                font-size: 1.5rem;
            }

            .number-card .count {
                font-size: 0.8rem;
            }
        }
        /* Barre navigation moteur */
        .engine-nav-subpage {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 20px;
            background: var(--theme-bg-nav);
            position: relative;
            z-index: 100;
            transition: background 0.4s ease;
        }

        /* Zone droite de la nav (badge + switch) */
        .engine-nav-subpage .engine-nav-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .engine-nav-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 18px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            font-size: 0.95rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .engine-nav-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.4);
            transform: translateX(-4px);
        }

        .engine-nav-btn .nav-arrow {
            font-size: 1.1rem;
            transition: transform 0.3s ease;
        }

        .engine-nav-btn:hover .nav-arrow {
            transform: translateX(-3px);
        }

        .engine-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 8px 16px;
            background: rgba(16, 185, 129, 0.15);
            border: 1px solid rgba(16, 185, 129, 0.4);
            border-radius: 20px;
            color: #10b981;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .engine-badge::before {
            content: '‚óè';
            font-size: 0.6rem;
            animation: pulse-dot 2s ease-in-out infinite;
        }

        @keyframes pulse-dot {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }

        @media (max-width: 480px) {
            .engine-nav-subpage {
                padding: 10px 15px;
            }

            .engine-nav-btn {
                padding: 8px 14px;
                font-size: 0.85rem;
            }

            .engine-nav-btn .nav-text {
                display: none;
            }

            .engine-nav-btn .nav-arrow {
                font-size: 1.3rem;
            }

            .engine-badge {
                padding: 6px 12px;
                font-size: 0.75rem;
            }
        }
    </style>
</head>
<body class="stats-page">
    <!-- Barre de navigation moteur -->
    <nav class="engine-nav-subpage">
        <a href="/ui/loto.html" class="engine-nav-btn">
            <span class="nav-arrow">‚Üê</span>
            <span class="nav-text">Retour au moteur</span>
        </a>
        <div class="engine-nav-right">
            <span class="engine-badge">Loto France</span>
            <button id="theme-switch" class="theme-switch" title="Changer de th√®me">
                <span class="icon-day">‚òÄÔ∏è</span>
                <span class="icon-night">üåô</span>
            </button>
        </div>
    </nav>

    <!-- Header Premium -->
    <header class="page-header">
        <div class="header-content">
            <h1><span>üìä</span> Statistiques</h1>
            <p class="subtitle">Explorez l'historique complet et analysez les donn√©es des tirages.</p>
        </div>
    </header>

    <!-- Contenu principal -->
    <div class="stats-container">
        <div class="tabs-card">
            <div class="tabs">
                <button class="tab active" onclick="switchTab('historique')">üìÖ Historique des tirages</button>
                <button class="tab" onclick="switchTab('analyse')">üîç Analyse par num√©ro</button>
                <button class="tab" onclick="switchTab('topflop')">üìå Top / Flop</button>
            </div>

            <!-- ONGLET 1 : Historique des tirages -->
            <div id="tab-historique" class="tab-content active">
                <div class="search-form">
                    <label for="draw_date">Rechercher un tirage par date</label>
                    <div class="input-group">
                        <input type="date" id="draw_date" name="draw_date">
                        <button onclick="searchDraw()" class="btn-primary">Rechercher</button>
                    </div>
                </div>

                <div id="search-result" style="display: none;"></div>

                <div class="info-note">
                    <strong>√Ä propos de l'historique :</strong><br>
                    Cette base contient les tirages officiels du Loto. Utilisez le s√©lecteur de date pour consulter un tirage sp√©cifique.
                </div>
            </div>

            <!-- ONGLET 2 : Analyse par num√©ro -->
            <div id="tab-analyse" class="tab-content">
                <div class="number-selector">
                    <label for="number-select"><strong>S√©lectionnez un num√©ro :</strong></label>
                    <select id="number-select">
                        <option value="">-- Choisir --</option>
                    </select>
                    <button onclick="analyzeNumber()" class="btn-primary">Analyser</button>
                </div>

                <div id="analysis-result" style="display: none;">
                    <h2 id="analysis-title" style="margin-bottom: 20px; color: var(--primary);"></h2>

                    <div class="stats-cards">
                        <div class="stat-card">
                            <div class="stat-label">Nombre de sorties</div>
                            <div class="stat-value" id="stat-appearances">-</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Premi√®re apparition</div>
                            <div class="stat-value" id="stat-first" style="font-size: 1.3rem;">-</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Derni√®re apparition</div>
                            <div class="stat-value" id="stat-last" style="font-size: 1.3rem;">-</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">√âcart actuel</div>
                            <div class="stat-value" id="stat-gap">-</div>
                        </div>
                    </div>

                    <div class="dates-list">
                        <h3>Dates d'apparition</h3>
                        <div id="dates-container"></div>
                        <button id="show-all-dates" onclick="toggleAllDates()" class="btn btn-secondary" style="margin-top: 16px; display: none;">
                            Voir toutes les dates
                        </button>
                    </div>

                    <div class="info-note">
                        <strong>Vocabulaire :</strong><br>
                        ‚Ä¢ <strong>Sorties</strong> : nombre de fois o√π le num√©ro est apparu dans l'historique.<br>
                        ‚Ä¢ <strong>√âcart actuel</strong> : nombre de tirages depuis la derni√®re apparition du num√©ro.<br>
                        Ces donn√©es sont purement descriptives et n'impliquent aucune pr√©diction.
                    </div>
                </div>
            </div>

            <!-- ONGLET 3 : Top / Flop -->
            <div id="tab-topflop" class="tab-content">
                <p style="margin-bottom: 24px; color: var(--text-muted);">
                    Fr√©quence d'apparition de chaque num√©ro sur l'ensemble de l'historique.
                </p>

                <!-- Section TOP -->
                <div class="topflop-section">
                    <h3 class="top-title">üèÜ Num√©ros les plus sortis</h3>
                    <div id="top-grid" class="numbers-grid">
                        <!-- Rempli dynamiquement par JavaScript -->
                    </div>
                    <button id="show-all-top" onclick="toggleTopView()" class="btn-secondary">
                        Voir tous les num√©ros
                    </button>
                </div>

                <!-- Section FLOP -->
                <div class="topflop-section">
                    <h3 class="flop-title">üìâ Num√©ros les moins sortis</h3>
                    <div id="flop-grid" class="numbers-grid">
                        <!-- Rempli dynamiquement par JavaScript -->
                    </div>
                    <button id="show-all-flop" onclick="toggleFlopView()" class="btn-secondary">
                        Voir tous les num√©ros
                    </button>
                </div>

                <div class="info-note">
                    <strong>√Ä propos de ces donn√©es :</strong><br>
                    Ces fr√©quences repr√©sentent le nombre de sorties de chaque num√©ro sur l'ensemble de l'historique.
                    Elles sont purement descriptives et n'impliquent aucune pr√©diction sur les tirages futurs.
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-nav">
                <a href="/ui/loto.html">Accueil</a>
                <span class="footer-sep">‚Ä¢</span>
                <a href="/ui/simulateur.html">Simulateur</a>
                <span class="footer-sep">‚Ä¢</span>
                <a href="/ui/statistiques.html" class="active">Statistiques</a>
                <span class="footer-sep">‚Ä¢</span>
                <a href="/ui/news.html">Actualit√©s</a>
                <span class="footer-sep">‚Ä¢</span>
                <a href="/ui/faq.html">FAQ</a>
            </div>
            <div class="footer-legal">
                <a href="/ui/mentions-legales.html">Mentions l√©gales</a>
                <span class="footer-sep">‚Ä¢</span>
                <a href="/ui/politique-confidentialite.html">Confidentialit√©</a>
                <span class="footer-sep">‚Ä¢</span>
                <a href="/ui/politique-cookies.html">Cookies</a>
            </div>
            <p class="footer-brand">LotoIA.fr v1.0</p>
            <p class="footer-disclaimer">Jouer comporte des risques : endettement, isolement, d√©pendance. Appelez le 09 74 75 13 13 (appel non surtax√©).</p>
            <p class="footer-help">Interdiction de jeu aux mineurs. <a href="https://www.joueurs-info-service.fr" target="_blank" rel="noopener">Joueurs Info Service</a></p>
            <div class="credits">
                <p class="dev-by">D√©velopp√© par <strong>JyppY</strong></p>
            </div>
        </footer>
    </div>

    <script>
        // Variables globales
        let allDates = [];
        let showingAllDates = false;

        // Initialisation : remplir le s√©lecteur de num√©ros
        document.addEventListener('DOMContentLoaded', function() {
            const select = document.getElementById('number-select');
            for (let i = 1; i <= 49; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = i;
                select.appendChild(option);
            }

            // Permettre la recherche avec Entr√©e sur l'historique
            document.getElementById('draw_date').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    searchDraw();
                }
            });
        });

        // Gestion des onglets
        function switchTab(tabName) {
            // D√©sactiver tous les onglets
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            // Activer l'onglet s√©lectionn√©
            event.target.classList.add('active');
            document.getElementById(`tab-${tabName}`).classList.add('active');
        }

        // HISTORIQUE : Recherche d'un tirage
        function searchDraw() {
            const dateInput = document.getElementById('draw_date');
            const resultDiv = document.getElementById('search-result');
            const date = dateInput.value;

            if (!date) {
                resultDiv.className = 'search-result error';
                resultDiv.innerHTML = '<strong>Erreur :</strong> Veuillez s√©lectionner une date.';
                resultDiv.style.display = 'block';
                return;
            }

            // Appel √† l'API
            fetch(`/draw/${date}`)
                .then(response => response.json())
                .then(data => {
                    if (data.success && data.found) {
                        const draw = data.draw;
                        resultDiv.className = 'search-result';
                        resultDiv.innerHTML = `
                            <h2 style="margin-bottom: 16px; color: var(--primary);">Tirage du ${formatDate(draw.date)}</h2>
                            <p><strong>Num√©ros gagnants :</strong></p>
                            <div class="draw-numbers">
                                <div class="draw-number">${draw.n1}</div>
                                <div class="draw-number">${draw.n2}</div>
                                <div class="draw-number">${draw.n3}</div>
                                <div class="draw-number">${draw.n4}</div>
                                <div class="draw-number">${draw.n5}</div>
                            </div>
                            <p><strong>Num√©ro Chance :</strong></p>
                            <div class="draw-numbers">
                                <div class="draw-number chance">${draw.chance}</div>
                            </div>
                        `;
                        resultDiv.style.display = 'block';
                    } else if (data.success && !data.found) {
                        resultDiv.className = 'search-result not-found';
                        resultDiv.innerHTML = `<strong>Aucun tirage trouv√© pour la date ${formatDate(date)}</strong>`;
                        resultDiv.style.display = 'block';
                    } else {
                        resultDiv.className = 'search-result error';
                        resultDiv.innerHTML = `<strong>Erreur :</strong> ${data.message || 'Une erreur est survenue'}`;
                        resultDiv.style.display = 'block';
                    }
                })
                .catch(error => {
                    resultDiv.className = 'search-result error';
                    resultDiv.innerHTML = `<strong>Erreur r√©seau :</strong> ${error.message}`;
                    resultDiv.style.display = 'block';
                });
        }

        // ANALYSE : Analyser un num√©ro
        function analyzeNumber() {
            const select = document.getElementById('number-select');
            const number = select.value;
            const resultDiv = document.getElementById('analysis-result');

            if (!number) {
                alert('Veuillez s√©lectionner un num√©ro.');
                return;
            }

            // Appel √† l'API
            fetch(`/api/stats/number/${number}`)
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        // Afficher le titre
                        document.getElementById('analysis-title').textContent = `Analyse historique du num√©ro ${data.number}`;

                        // Remplir les statistiques
                        document.getElementById('stat-appearances').textContent = data.total_appearances;
                        document.getElementById('stat-first').textContent = data.first_appearance ? formatDate(data.first_appearance) : 'N/A';
                        document.getElementById('stat-last').textContent = data.last_appearance ? formatDate(data.last_appearance) : 'N/A';
                        document.getElementById('stat-gap').textContent = data.current_gap + ' tirages';

                        // Stocker toutes les dates
                        allDates = data.appearance_dates;

                        // Afficher les 10 derni√®res dates par d√©faut
                        displayDates(false);

                        // Afficher le bouton "Voir tout" si plus de 10 dates
                        const showAllBtn = document.getElementById('show-all-dates');
                        if (allDates.length > 10) {
                            showAllBtn.style.display = 'inline-block';
                            showAllBtn.textContent = 'Voir toutes les dates';
                            showingAllDates = false;
                        } else {
                            showAllBtn.style.display = 'none';
                        }

                        // Afficher les r√©sultats
                        resultDiv.style.display = 'block';
                    } else {
                        alert('Erreur : ' + (data.message || 'Impossible d\'analyser le num√©ro'));
                    }
                })
                .catch(error => {
                    alert('Erreur r√©seau : ' + error.message);
                });
        }

        // Afficher les dates (10 derni√®res ou toutes)
        function displayDates(showAll) {
            const container = document.getElementById('dates-container');
            const datesToShow = showAll ? allDates : allDates.slice(-10).reverse();

            container.innerHTML = '';

            if (datesToShow.length === 0) {
                container.innerHTML = '<p style="color: var(--text-muted);">Aucune apparition enregistr√©e.</p>';
                return;
            }

            datesToShow.forEach(date => {
                const dateItem = document.createElement('div');
                dateItem.className = 'date-item';
                dateItem.textContent = formatDate(date);
                container.appendChild(dateItem);
            });
        }

        // Toggle affichage de toutes les dates
        function toggleAllDates() {
            showingAllDates = !showingAllDates;
            displayDates(showingAllDates);

            const btn = document.getElementById('show-all-dates');
            btn.textContent = showingAllDates ? 'Voir moins' : 'Voir toutes les dates';
        }

        // Formater une date YYYY-MM-DD en DD/MM/YYYY
        function formatDate(dateStr) {
            const [year, month, day] = dateStr.split('-');
            return `${day}/${month}/${year}`;
        }

        // ========== TOP / FLOP ==========

        // Variables globales pour Top/Flop
        let topData = [];
        let flopData = [];
        let showingAllTop = false;
        let showingAllFlop = false;

        // Charger les donn√©es Top/Flop au clic sur l'onglet
        function loadTopFlop() {
            fetch('/api/stats/top-flop')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        topData = data.top;
                        flopData = data.flop;

                        // Afficher les 10 premiers par d√©faut
                        displayTop(false);
                        displayFlop(false);
                    } else {
                        alert('Erreur : ' + (data.message || 'Impossible de charger les donn√©es'));
                    }
                })
                .catch(error => {
                    alert('Erreur r√©seau : ' + error.message);
                });
        }

        // Afficher les num√©ros TOP
        function displayTop(showAll) {
            const grid = document.getElementById('top-grid');
            const dataToShow = showAll ? topData : topData.slice(0, 10);

            grid.innerHTML = '';

            dataToShow.forEach(item => {
                const card = document.createElement('div');
                card.className = 'number-card top';
                card.innerHTML = `
                    <div class="number">${item.number}</div>
                    <div class="count">${item.count} sorties</div>
                `;
                grid.appendChild(card);
            });
        }

        // Afficher les num√©ros FLOP
        function displayFlop(showAll) {
            const grid = document.getElementById('flop-grid');
            const dataToShow = showAll ? flopData : flopData.slice(0, 10);

            grid.innerHTML = '';

            dataToShow.forEach(item => {
                const card = document.createElement('div');
                card.className = 'number-card flop';
                card.innerHTML = `
                    <div class="number">${item.number}</div>
                    <div class="count">${item.count} sorties</div>
                `;
                grid.appendChild(card);
            });
        }

        // Toggle vue TOP (10 ou tous)
        function toggleTopView() {
            showingAllTop = !showingAllTop;
            displayTop(showingAllTop);

            const btn = document.getElementById('show-all-top');
            btn.textContent = showingAllTop ? 'Voir moins' : 'Voir tous les num√©ros';
        }

        // Toggle vue FLOP (10 ou tous)
        function toggleFlopView() {
            showingAllFlop = !showingAllFlop;
            displayFlop(showingAllFlop);

            const btn = document.getElementById('show-all-flop');
            btn.textContent = showingAllFlop ? 'Voir moins' : 'Voir tous les num√©ros';
        }

        // Modifier la fonction switchTab pour charger Top/Flop si n√©cessaire
        const originalSwitchTab = switchTab;
        function switchTab(tabName) {
            // D√©sactiver tous les onglets
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            // Activer l'onglet s√©lectionn√©
            event.target.classList.add('active');
            document.getElementById(`tab-${tabName}`).classList.add('active');

            // Charger les donn√©es Top/Flop si c'est le premier acc√®s √† l'onglet
            if (tabName === 'topflop' && topData.length === 0) {
                loadTopFlop();
            }
        }
    </script>
    <script src="/ui/static/cookie-consent.js"></script>
</body>
</html>
