<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, interactive-widget=resizes-content">
    <title>EuroMillions Statistics - Frequencies and Trends | LotoIA</title>
    <meta name="description" content="Complete EuroMillions statistics: number and star frequencies, trends, hot and cold numbers, draw history.">
    <meta name="keywords" content="euromillions statistics, euromillions number frequencies, euromillions stars, HYBRIDE engine, hot cold numbers, HYBRIDE, euromillions trends">
    <link rel="canonical" href="https://lotoia.fr/en/euromillions/statistics">

    <!-- hreflang -->
    <link rel="alternate" hreflang="fr" href="https://lotoia.fr/euromillions/statistiques">
    <link rel="alternate" hreflang="en" href="https://lotoia.fr/en/euromillions/statistics">
    <link rel="alternate" hreflang="x-default" href="https://lotoia.fr/euromillions/statistiques">

    <!-- Favicon -->
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/ui/static/favicon.svg" type="image/svg+xml">
    <link rel="shortcut icon" href="/favicon.ico">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="LotoIA">
    <meta property="og:locale" content="en_GB">
    <meta property="og:title" content="EuroMillions Statistics | LotoIA">
    <meta property="og:description" content="Frequencies, trends and hot/cold numbers for EuroMillions.">
    <meta property="og:url" content="https://lotoia.fr/en/euromillions/statistics">
    <meta property="og:image" content="https://lotoia.fr/static/og-image.jpg">
    <meta property="og:image:secure_url" content="https://lotoia.fr/static/og-image.jpg">
    <meta property="og:image:type" content="image/jpeg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="EuroMillions Statistics | LotoIA">
    <meta name="twitter:description" content="Frequencies, trends and hot/cold numbers for EuroMillions.">
    <meta name="twitter:image" content="https://lotoia.fr/static/og-image.jpg">

    <!-- JSON-LD Schema.org -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Dataset",
      "name": "EuroMillions Draw History",
      "description": "Complete EuroMillions draw dataset: winning numbers (5 balls + 2 stars), appearance frequencies, gaps between appearances, statistical trends. Data sourced from official results, analysed by the HYBRIDE engine.",
      "url": "https://lotoia.fr/en/euromillions/statistics",
      "identifier": "lotoia-euromillions-tirages",
      "license": "https://www.etalab.gouv.fr/licence-ouverte-open-licence/",
      "isAccessibleForFree": true,
      "creator": {
        "@type": "Organization",
        "name": "LotoIA",
        "url": "https://lotoia.fr"
      },
      "publisher": {
        "@type": "Organization",
        "name": "LotoIA",
        "url": "https://lotoia.fr"
      },
      "temporalCoverage": "2004/2026",
      "spatialCoverage": "Europe",
      "variableMeasured": [
        {"@type": "PropertyValue", "name": "Winning numbers", "description": "5 balls (1-50) + 2 stars (1-12) per draw"},
        {"@type": "PropertyValue", "name": "Appearance frequency", "description": "Number of appearances of each number and star over the period"},
        {"@type": "PropertyValue", "name": "Current gap", "description": "Number of draws since last appearance"},
        {"@type": "PropertyValue", "name": "Draw date", "description": "Date of each draw (Tuesday, Friday)"}
      ],
      "distribution": {
        "@type": "DataDownload",
        "encodingFormat": "application/pdf",
        "contentUrl": "https://lotoia.fr/api/euromillions/meta-pdf",
        "name": "EuroMillions META DATA Report — PDF"
      },
      "keywords": ["euromillions", "draws", "frequencies", "statistics", "stars", "Europe"]
    }
    </script>

    <link rel="stylesheet" href="/ui/static/style.css?v=1">
    <link rel="stylesheet" href="/ui/static/style-em.css?v=1">
    <link rel="stylesheet" href="/ui/static/legal.css?v=1">
    <!-- Theme script (first to avoid flash) -->
    <script src="/ui/static/theme.js?v=1"></script>
    <!-- Analytics (loaded after GDPR consent) -->
    <script src="/ui/static/analytics.js?v=1" defer></script>

    <style>
        /* =================================================================
           STATISTIQUES EUROMILLIONS — Styles specifiques
           Herite du chassis unifie (style.css + style-em.css) :
           page-header, loto-hero-header, engine-nav-subpage,
           loto-hero-actions, loto-hero-btn
           ================================================================= */

        /* ---- Container (jointure header -> carte) ---- */
        .stats-container {
            max-width: var(--app-max-width, 1140px);
            margin: -50px auto 40px;
            padding: 0 var(--app-padding-x, 24px);
            position: relative;
            z-index: 10;
        }

        /* ---- Carte principale (onglets) ---- */
        .tabs-card {
            background: var(--theme-bg-card);
            border: 1px solid var(--theme-border);
            border-radius: 16px;
            padding: 32px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }

        /* ---- Onglets ---- */
        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 32px;
            border-bottom: 2px solid var(--theme-border);
            flex-wrap: wrap;
            position: relative;
            overflow: visible;
        }

        .tab {
            padding: 16px 24px;
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            color: var(--theme-text-muted);
            transition: all 0.3s ease;
            font-family: inherit;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab:hover {
            color: var(--primary);
            background: rgba(0, 51, 153, 0.05);
        }

        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.4s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* ---- Analyse par numero ---- */
        .number-selector {
            display: flex;
            gap: 12px;
            align-items: center;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .number-selector select {
            padding: 12px 16px;
            font-size: 1.05rem;
            border: 2px solid var(--theme-border);
            border-radius: 8px;
            font-family: inherit;
            min-width: 120px;
            background: var(--theme-bg-input, var(--theme-bg-card));
            color: var(--theme-text-primary);
        }

        .number-selector select:focus {
            outline: none;
            border-color: var(--primary);
        }

        .number-selector label {
            font-weight: 600;
            color: var(--theme-text-primary);
        }

        .analysis-section {
            margin-bottom: 32px;
            padding-bottom: 24px;
            border-bottom: 1px solid var(--theme-border);
        }

        .analysis-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .analysis-section h3 {
            font-size: 1.2rem;
            margin-bottom: 16px;
            color: var(--theme-text-primary);
        }

        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: var(--bg-light);
            border-left: 4px solid var(--primary);
            padding: 20px;
            border-radius: 8px;
        }

        .stat-card.star-accent {
            border-left-color: #FFD700;
        }

        .stat-card .stat-label {
            font-size: 0.9rem;
            color: var(--theme-text-muted);
            margin-bottom: 8px;
        }

        .stat-card .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--theme-text-primary);
        }

        .info-note {
            background: rgba(0, 51, 153, 0.08);
            border-left: 4px solid #003399;
            padding: 16px;
            border-radius: 8px;
            margin-top: 24px;
            font-size: 0.95rem;
            color: var(--theme-text-primary);
        }

        /* ---- Historique ---- */
        .search-form {
            margin-bottom: 24px;
        }

        .search-form label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--theme-text-primary);
        }

        .search-form .input-group {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .search-form input[type="date"] {
            padding: 12px 16px;
            font-size: 1.05rem;
            border: 2px solid var(--theme-border);
            border-radius: 8px;
            font-family: inherit;
            background: var(--theme-bg-input, var(--theme-bg-card));
            color: var(--theme-text-primary);
        }

        .search-result {
            background: var(--bg-light);
            border-radius: 8px;
            padding: 24px;
            margin-top: 24px;
            color: var(--theme-text-primary);
        }

        .search-result.error {
            background: rgba(239, 68, 68, 0.08);
            border-left: 4px solid var(--error);
            color: var(--error);
        }

        .search-result.not-found {
            background: rgba(245, 124, 0, 0.08);
            border-left: 4px solid #F57C00;
            color: #F57C00;
        }

        /* ---- Boules de tirage ---- */
        .draw-numbers {
            display: flex;
            gap: 12px;
            margin: 16px 0;
            flex-wrap: wrap;
            align-items: center;
        }

        .number-ball {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 700;
            color: white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .number-ball.main {
            background: linear-gradient(135deg, #4d88ff, #003399);
            box-shadow: 0 4px 8px rgba(0, 51, 153, 0.4);
        }

        .number-ball.star {
            background: linear-gradient(135deg, #FFD700, #F57C00);
            box-shadow: 0 4px 8px rgba(255, 215, 0, 0.4);
        }

        .separator {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--theme-text-muted);
            padding: 0 4px;
        }

        /* ---- Top / Flop ---- */
        .topflop-category {
            margin-bottom: 40px;
        }

        .topflop-category > h3 {
            font-size: 1.4rem;
            margin-bottom: 20px;
            color: var(--theme-text-primary);
            padding-bottom: 8px;
            border-bottom: 2px solid var(--theme-border);
        }

        .topflop-section {
            margin-bottom: 32px;
        }

        .topflop-section h4 {
            font-size: 1.15rem;
            margin-bottom: 16px;
            color: var(--theme-text-primary);
        }

        .topflop-section h4.top-title {
            color: var(--success);
        }

        .topflop-section h4.flop-title {
            color: var(--tertiary);
        }

        .numbers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 12px;
            margin-bottom: 16px;
        }

        .number-card {
            background: var(--bg-light);
            border-radius: 8px;
            padding: 16px 12px;
            text-align: center;
            border: 2px solid var(--theme-border);
            transition: all 0.3s ease;
        }

        .number-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .number-card.top {
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.06);
        }

        .number-card.flop {
            border-color: var(--tertiary);
            background: var(--bg-light);
        }

        .number-card .number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 8px;
        }

        .number-card.top .number {
            color: var(--success);
        }

        .number-card.flop .number {
            color: var(--tertiary);
        }

        .number-card.star-card .number {
            color: #F57C00;
        }

        .number-card.star-card.top .number {
            color: var(--success);
        }

        .number-card.star-card.flop .number {
            color: var(--tertiary);
        }

        .number-card .count {
            font-size: 0.9rem;
            color: var(--theme-text-muted);
        }

        /* ---- Responsive ---- */
        @media (max-width: 768px) {
            .numbers-grid {
                grid-template-columns: repeat(5, 1fr);
                gap: 8px;
            }

            .number-card {
                padding: 12px 8px;
            }

            .number-card .number {
                font-size: 1.5rem;
            }

            .number-card .count {
                font-size: 0.8rem;
            }

            .tabs-card {
                padding: 20px 16px;
            }

            .tab {
                padding: 12px 16px;
                font-size: 0.9rem;
            }

            .number-ball {
                width: 50px;
                height: 50px;
                font-size: 1.25rem;
            }
        }

        @media (max-width: 480px) {
            .tab {
                padding: 10px 12px;
                font-size: 0.85rem;
            }

            .number-selector {
                flex-direction: column;
                gap: 10px;
            }

            .number-selector select,
            .number-selector button {
                width: 100%;
            }

            .number-ball {
                width: 44px;
                height: 44px;
                font-size: 1.1rem;
            }
        }
    </style>
    <script>function umamiBeforeSend(t,p){return window.__OWNER__?false:p;}</script>
    <script defer src="https://cloud.umami.is/script.js" data-website-id="e6add519-5d39-42cd-b4bf-b795f4408dcc" data-before-send="umamiBeforeSend"></script>
</head>
<body class="stats-page em-page">
    <!-- Engine navigation bar -->
    <nav class="engine-nav-subpage">
        <a href="/en/euromillions" class="engine-nav-btn">
            <span class="nav-arrow">&larr;</span>
            <span class="nav-text">EuroMillions Home</span>
        </a>
        <div class="engine-nav-right">
            <span class="engine-badge">EuroMillions</span>
            <a href="/euromillions/statistiques" class="lang-switch" title="Version fran&ccedil;aise">&#127467;&#127479; FR</a>
            <button id="theme-switch" class="theme-switch" title="Switch theme">
                <span class="icon-day">&#9728;&#65039;</span>
                <span class="icon-night">&#127769;</span>
            </button>
        </div>
    </nav>

    <!-- Header Premium — pattern aligned with Audit / Explore -->
    <header class="page-header loto-hero-header">
        <div class="header-content">
            <h1><span>&#128202;</span> EuroMillions Statistics</h1>
            <p class="subtitle">Frequencies, trends and analysis of numbers and stars</p>
            <div class="loto-hero-actions">
                <a href="/en/euromillions/simulator" class="loto-hero-btn">
                    <span class="loto-hero-btn-icon">&#127919;</span>
                    Audit a grid
                </a>
                <a href="/en/euromillions/generator" class="loto-hero-btn">
                    <span class="loto-hero-btn-icon">&#129504;</span>
                    Explore grids
                </a>
                <a href="/en/euromillions/statistics" class="loto-hero-btn loto-hero-btn-active">
                    <span class="loto-hero-btn-icon">&#128202;</span>
                    Statistics
                </a>
                <a href="/en/euromillions/news" class="loto-hero-btn loto-hero-btn-news">
                    <span class="loto-hero-btn-icon">&#128240;</span>
                    News
                </a>
            </div>
            <p class="loto-hero-scroll-hint">&larr; swipe to see more &rarr;</p>
        </div>
    </header>

    <!-- Main content -->
    <div class="stats-container">
        <div class="tabs-card">
            <div class="tabs">
                <button class="tab active" onclick="switchTab('historique')">&#128197; Draw history</button>
                <button class="tab" onclick="switchTab('analyse')">&#128269; Analysis by number</button>
                <button class="tab" onclick="switchTab('topflop')">&#128204; Top / Flop</button>
            </div>

            <!-- TAB 1 : Draw history -->
            <div id="tab-historique" class="tab-content active">
                <div class="search-form">
                    <label for="search-date">Search for a draw by date</label>
                    <div class="input-group">
                        <input type="date" id="search-date" name="search-date">
                        <button onclick="searchDraw()" class="btn-primary">Search</button>
                    </div>
                </div>

                <div id="draw-result"></div>

                <div class="info-note">
                    <strong>About draw history:</strong><br>
                    This database contains the official EuroMillions draws. Use the date picker to look up a specific draw.
                    Numbers range from 1 to 50, stars from 1 to 12.
                </div>
            </div>

            <!-- TAB 2 : Analysis by number -->
            <div id="tab-analyse" class="tab-content">
                <!-- Numbers section -->
                <div class="analysis-section">
                    <h3>Number analysis (1-50)</h3>
                    <div class="number-selector">
                        <label for="number-select"><strong>Number:</strong></label>
                        <select id="number-select">
                            <option value="">-- Select --</option>
                        </select>
                        <button onclick="searchNumber()" class="btn-primary">Analyse</button>
                    </div>
                    <div id="number-result"></div>
                </div>

                <!-- Stars section -->
                <div class="analysis-section">
                    <h3>Star analysis (1-12)</h3>
                    <div class="number-selector">
                        <label for="star-select"><strong>Star:</strong></label>
                        <select id="star-select">
                            <option value="">-- Select --</option>
                        </select>
                        <button onclick="searchStar()" class="btn-primary">Analyse</button>
                    </div>
                    <div id="star-result"></div>
                </div>

                <div class="info-note">
                    <strong>Glossary:</strong><br>
                    &bull; <strong>Frequency</strong>: number of times the number/star has appeared in the history.<br>
                    &bull; <strong>Current gap</strong>: number of draws since its last appearance.<br>
                    &bull; <strong>Average gap</strong>: average interval between two appearances.<br>
                    &bull; <strong>Category</strong>: classification of the number (hot, warm, cold).<br>
                    These data are purely descriptive and do not imply any prediction.
                </div>
            </div>

            <!-- TAB 3 : Top / Flop -->
            <div id="tab-topflop" class="tab-content">
                <p style="margin-bottom: 24px; color: var(--text-muted);">
                    Appearance frequency of each number and star across the entire draw history.
                </p>

                <!-- Numbers -->
                <div class="topflop-category">
                    <h3>&#127920; Numbers (1-50)</h3>

                    <div class="topflop-section">
                        <h4 class="top-title">&#127942; Most drawn numbers</h4>
                        <div id="top-numbers-grid" class="numbers-grid"></div>
                    </div>

                    <div class="topflop-section">
                        <h4 class="flop-title">&#128201; Least drawn numbers</h4>
                        <div id="flop-numbers-grid" class="numbers-grid"></div>
                    </div>
                </div>

                <!-- Stars -->
                <div class="topflop-category">
                    <h3>&#11088; Stars (1-12)</h3>

                    <div class="topflop-section">
                        <h4 class="top-title">&#127942; Most drawn stars</h4>
                        <div id="top-stars-grid" class="numbers-grid"></div>
                    </div>

                    <div class="topflop-section">
                        <h4 class="flop-title">&#128201; Least drawn stars</h4>
                        <div id="flop-stars-grid" class="numbers-grid"></div>
                    </div>
                </div>

                <div class="info-note">
                    <strong>About this data:</strong><br>
                    These frequencies represent the number of times each number and star has been drawn across the entire history.
                    They are purely descriptive and do not imply any prediction about future draws.
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-nav">
                <a href="/">Modules</a>
                <span class="footer-sep">&bull;</span>
                <a href="/en/euromillions">Home</a>
                <span class="footer-sep">&bull;</span>
                <a href="/en/euromillions/simulator">Audit</a>
                <span class="footer-sep">&bull;</span>
                <a href="/en/euromillions/generator">Explore</a>
                <span class="footer-sep">&bull;</span>
                <a href="/en/euromillions/statistics" class="active">Statistics</a>
                <span class="footer-sep">&bull;</span>
                <a href="/en/euromillions/news">News</a>
                <span class="footer-sep">&bull;</span>
                <a href="/en/euromillions/faq">FAQ</a>
            </div>
            <div class="footer-legal">
                <a href="/mentions-legales">Legal notice</a>
                <span class="footer-sep">&bull;</span>
                <a href="/politique-confidentialite">Privacy</a>
                <span class="footer-sep">&bull;</span>
                <a href="/politique-cookies">Cookies</a>
                <span class="footer-sep">&bull;</span>
                <a href="/disclaimer">Disclaimer</a>
            </div>
            <p class="footer-brand">LotoIA.fr <span class="app-version">v1.001</span></p>
            <p class="footer-disclaimer">Gambling involves risks: debt, isolation, addiction. Call the National Gambling Helpline: 0808 8020 133 (free, confidential).</p>
            <p class="footer-help">You must be 18 or over to play. <a href="https://www.begambleaware.org" target="_blank" rel="noopener">BeGambleAware.org</a></p>
            <div class="credits">
                <p class="dev-by">Developed by <strong>JyppY</strong></p>
            </div>
        </footer>
    </div>

    <script>
        // =====================================================================
        //  INITIALISATION
        // =====================================================================

        document.addEventListener('DOMContentLoaded', function() {
            // Remplir le selecteur de numeros (1-50)
            var numberSelect = document.getElementById('number-select');
            for (var i = 1; i <= 50; i++) {
                var option = document.createElement('option');
                option.value = i;
                option.textContent = i;
                numberSelect.appendChild(option);
            }

            // Remplir le selecteur d'etoiles (1-12)
            var starSelect = document.getElementById('star-select');
            for (var j = 1; j <= 12; j++) {
                var opt = document.createElement('option');
                opt.value = j;
                opt.textContent = j;
                starSelect.appendChild(opt);
            }

            // Permettre la recherche avec Entree sur l'historique
            document.getElementById('search-date').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    searchDraw();
                }
            });
        });

        // =====================================================================
        //  GESTION DES ONGLETS
        // =====================================================================

        var topFlopLoaded = false;

        function switchTab(tabName) {
            // Desactiver tous les onglets
            document.querySelectorAll('.tab').forEach(function(tab) { tab.classList.remove('active'); });
            document.querySelectorAll('.tab-content').forEach(function(content) { content.classList.remove('active'); });

            // Activer l'onglet selectionne
            event.target.closest('.tab').classList.add('active');
            document.getElementById('tab-' + tabName).classList.add('active');

            // Charger les donnees Top/Flop si premier acces
            if (tabName === 'topflop' && !topFlopLoaded) {
                loadTopFlop();
            }
        }

        // =====================================================================
        //  ONGLET 1 : HISTORIQUE — Recherche d'un tirage par date
        // =====================================================================

        async function searchDraw() {
            var date = document.getElementById('search-date').value;
            if (!date) return;
            var resultDiv = document.getElementById('draw-result');
            resultDiv.innerHTML = '<p>Searching...</p>';
            try {
                var response = await fetch('/api/euromillions/draw/' + date);
                var data = await response.json();
                if (data.success && data.found) {
                    var d = data.draw;
                    var html = '<div class="search-result">';
                    html += '<h3 style="margin-bottom: 16px; color: var(--primary);">Draw of ' + d.date.split('-').reverse().join('/') + '</h3>';
                    html += '<p><strong>Winning numbers:</strong></p>';
                    html += '<div class="draw-numbers">';
                    [d.n1, d.n2, d.n3, d.n4, d.n5].sort(function(a,b){return a-b;}).forEach(function(n) {
                        html += '<span class="number-ball main">' + String(n).padStart(2,'0') + '</span>';
                    });
                    html += '<span class="separator">+</span>';
                    [d.etoile_1, d.etoile_2].sort(function(a,b){return a-b;}).forEach(function(n) {
                        html += '<span class="number-ball star">' + String(n).padStart(2,'0') + '</span>';
                    });
                    html += '</div>';
                    html += '</div>';
                    resultDiv.innerHTML = html;
                } else if (data.success && !data.found) {
                    resultDiv.innerHTML = '<div class="search-result not-found"><strong>No draw found for this date.</strong></div>';
                } else {
                    resultDiv.innerHTML = '<div class="search-result error"><strong>' + (data.message || 'Internal server error') + '</strong></div>';
                }
            } catch(e) {
                resultDiv.innerHTML = '<div class="search-result error"><strong>Connection error.</strong></div>';
            }
        }

        // =====================================================================
        //  ONGLET 2 : ANALYSE PAR NUMERO / ETOILE
        // =====================================================================

        async function searchNumber() {
            var select = document.getElementById('number-select');
            var number = select.value;
            var resultDiv = document.getElementById('number-result');

            if (!number) {
                alert('Please select a number.');
                return;
            }

            resultDiv.innerHTML = '<p>Analysing...</p>';

            try {
                var response = await fetch('/api/euromillions/stats/number/' + number);
                var data = await response.json();

                if (data.success) {
                    var s = data.data || data;
                    var html = '<h4 style="margin: 16px 0; color: var(--primary);">Number ' + String(number).padStart(2,'0') + '</h4>';
                    html += '<div class="stats-cards">';
                    html += buildStatCard('Frequency', s.frequence || s.total_appearances || '-', '');
                    html += buildStatCard('Percentage', s.pourcentage !== undefined ? s.pourcentage + '%' : '-', '');
                    html += buildStatCard('Last drawn', s.derniere_sortie || s.last_appearance || '-', 'small');
                    html += buildStatCard('Current gap', s.ecart_actuel !== undefined ? s.ecart_actuel + ' draws' : (s.current_gap !== undefined ? s.current_gap + ' draws' : '-'), '');
                    html += buildStatCard('Average gap', s.ecart_moyen !== undefined ? s.ecart_moyen : '-', '');
                    html += buildStatCard('Ranking', s.classement || '-', '');
                    html += '</div>';
                    if (s.categorie) {
                        html += '<p style="margin-top: 8px;"><strong>Category:</strong> ' + s.categorie + '</p>';
                    }
                    resultDiv.innerHTML = html;
                } else {
                    resultDiv.innerHTML = '<div class="search-result error"><strong>Error:</strong> ' + (data.message || 'Unable to analyse this number') + '</div>';
                }
            } catch(e) {
                resultDiv.innerHTML = '<div class="search-result error"><strong>Network error:</strong> ' + e.message + '</div>';
            }
        }

        async function searchStar() {
            var select = document.getElementById('star-select');
            var star = select.value;
            var resultDiv = document.getElementById('star-result');

            if (!star) {
                alert('Please select a star.');
                return;
            }

            resultDiv.innerHTML = '<p>Analysing...</p>';

            try {
                var response = await fetch('/api/euromillions/stats/etoile/' + star);
                var data = await response.json();

                if (data.success) {
                    var s = data.data || data;
                    var html = '<h4 style="margin: 16px 0; color: #F57C00;">Star ' + String(star).padStart(2,'0') + '</h4>';
                    html += '<div class="stats-cards">';
                    html += buildStatCard('Frequency', s.frequence || s.total_appearances || '-', 'star-accent');
                    html += buildStatCard('Percentage', s.pourcentage !== undefined ? s.pourcentage + '%' : '-', 'star-accent');
                    html += buildStatCard('Last drawn', s.derniere_sortie || s.last_appearance || '-', 'star-accent small');
                    html += buildStatCard('Current gap', s.ecart_actuel !== undefined ? s.ecart_actuel + ' draws' : (s.current_gap !== undefined ? s.current_gap + ' draws' : '-'), 'star-accent');
                    html += buildStatCard('Average gap', s.ecart_moyen !== undefined ? s.ecart_moyen : '-', 'star-accent');
                    html += buildStatCard('Ranking', s.classement || '-', 'star-accent');
                    html += '</div>';
                    if (s.categorie) {
                        html += '<p style="margin-top: 8px;"><strong>Category:</strong> ' + s.categorie + '</p>';
                    }
                    resultDiv.innerHTML = html;
                } else {
                    resultDiv.innerHTML = '<div class="search-result error"><strong>Error:</strong> ' + (data.message || 'Unable to analyse this star') + '</div>';
                }
            } catch(e) {
                resultDiv.innerHTML = '<div class="search-result error"><strong>Network error:</strong> ' + e.message + '</div>';
            }
        }

        function buildStatCard(label, value, extraClass) {
            var sizeStyle = '';
            if (extraClass && extraClass.indexOf('small') !== -1) {
                sizeStyle = ' style="font-size: 1.3rem;"';
            }
            var cls = 'stat-card';
            if (extraClass) {
                cls += ' ' + extraClass.replace('small', '').trim();
            }
            return '<div class="' + cls + '">' +
                '<div class="stat-label">' + label + '</div>' +
                '<div class="stat-value"' + sizeStyle + '>' + value + '</div>' +
                '</div>';
        }

        // =====================================================================
        //  ONGLET 3 : TOP / FLOP
        // =====================================================================

        async function loadTopFlop() {
            try {
                var response = await fetch('/api/euromillions/stats/top-flop');
                var data = await response.json();

                if (data.success) {
                    var d = data.data || data;

                    // Numeros — Top 5
                    var topNumbers = d.top_numbers || d.top || [];
                    var flopNumbers = d.flop_numbers || d.flop || [];
                    var topStars = d.top_stars || d.top_etoiles || [];
                    var flopStars = d.flop_stars || d.flop_etoiles || [];

                    displayRanking('top-numbers-grid', topNumbers.slice(0, 5), 'top', false);
                    displayRanking('flop-numbers-grid', flopNumbers.slice(0, 5), 'flop', false);
                    displayRanking('top-stars-grid', topStars.slice(0, 5), 'top', true);
                    displayRanking('flop-stars-grid', flopStars.slice(0, 5), 'flop', true);

                    topFlopLoaded = true;
                } else {
                    alert('Error: ' + (data.message || 'Unable to load data'));
                }
            } catch(e) {
                alert('Network error: ' + e.message);
            }
        }

        function displayRanking(gridId, items, type, isStar) {
            var grid = document.getElementById(gridId);
            grid.innerHTML = '';

            if (!items || items.length === 0) {
                grid.innerHTML = '<p style="color: var(--theme-text-muted);">No data available.</p>';
                return;
            }

            items.forEach(function(item) {
                var card = document.createElement('div');
                var cardClass = 'number-card ' + type;
                if (isStar) cardClass += ' star-card';
                card.className = cardClass;

                var num = item.number || item.numero || item.etoile || '-';
                var count = item.count || item.frequence || 0;

                card.innerHTML =
                    '<div class="number">' + String(num).padStart(2, '0') + '</div>' +
                    '<div class="count">' + count + ' draws</div>';
                grid.appendChild(card);
            });
        }
    </script>

    <!-- Scroll to Top button -->
    <button id="scroll-to-top" class="scroll-to-top" aria-label="Back to top">
        &uarr;
    </button>

    <script src="/ui/static/scroll.js?v=1"></script>
    <script src="/ui/static/nav-scroll.js?v=1"></script>
    <script src="/ui/static/cookie-consent.js?v=1"></script>

    <!-- HYBRIDE Chatbot Widget EuroMillions -->
    <link rel="stylesheet" href="/ui/static/hybride-chatbot.css?v=4.3">
    <div id="hybride-chatbot-root"></div>
    <script src="/ui/en/euromillions/static/hybride-chatbot-em-en.js?v=1.0"></script>
    <script src="/ui/static/version-inject.js"></script>

    <!-- Rating banner -->
    <link rel="stylesheet" href="/ui/static/rating-popup.css?v=1">
    <script src="/ui/static/rating-popup.js?v=1" defer></script>
</body>
</html>
